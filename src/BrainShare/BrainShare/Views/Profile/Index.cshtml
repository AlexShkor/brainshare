@model BrainShare.Controllers.MyProfileViewModel

@{
    Layout = "_ProfileLayout.cshtml";
}


@section Scripts{

    <script src="@Url.Content("~/Scripts/jquery.form.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/custom/Profile/myProfile.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/imgAreaSelect/jquery.imgareaselect.pack.js")" type="text/javascript"></script>

    @if (ViewBag.IsFacebookAccount)
    {
        <script type="text/javascript" src="@Url.Content("~/Scripts/custom/fbfriendsSelector.js")"></script>
    }

    <script type="text/javascript">
        var myProfileViewModel = new MyProfileViewModel();
        ko.applyBindings(myProfileViewModel);
    </script>
}

<div id="overlay" style="display: none" data-bind="visible: ShowOverlay"></div>

<div>

    <div id="fbFriendsSelector" style="position: absolute; left: 70%; top: 20%;"></div>


    @*@if (ViewBag.IsFacebookAccount)
        {
            <a id="selectorToggle" class=" badge badge-info" href="#">Друзья из Фэйсбука</a>
        }*@

    <div id="avatarContainer" class="pull-right" style="text-align: center;">
        <div class="avatar-container">
            @if (Model.AvatarUrl != null)
            {
                <img style="width: 250px; height: 250px" alt="аватар" class="pics" src="@Model.AvatarUrl"/>
            }

            @if (Model.AvatarUrl == null)
            {
                <img style="width: 250px; height: 250px" alt="аватар" src="http://critterapp.pagodabox.com/img/user.jpg" />
            }
        </div>

        <a href="#" data-bind="visible: ShowChangeAvatarButton, click: UploadImg" style="display: block; padding-top: 15px;">Выбрать аватар</a>
    </div>
</div>

<p class="error-mesage"></p>

<div style="display: none">
    @using (Html.BeginForm("UploadImage", "Profile", FormMethod.Post, new { enctype = "multipart/form-data", id = "myForm" }))
    {
        @Html.TextBox("UploadedFile", Model.UploadedFile, new { type = "file", id = "file" })
        @Html.ValidationMessage("UploadedFile")
                    
        <button type="submit" id="uploadImage" class="btn btn-primary">Upload</button>
    }
</div>


<div id="previewContainer" style="display: none; min-width: 300px" data-bind="visible: ShowPreviewControls">
    <div id="imgPreviewContainer"></div>
    <input type="hidden" id="avatarId" />
    <input type="hidden" id="avatarFormat" />

    <div>
        <button class="btn btn-primary btn-danger" style="float: left; margin-left: 7%; margin-top: 5%" data-bind="click: CancelImg">Отмена</button>
        <button class="btn btn-primary btn-success" style="float: right; margin-right: 7%; margin-top: 5%" data-bind="click: CropImg">Готово</button>
    </div>
</div>

<div class="fb-send" data-href="http://developers.facebook.com/docs/plugins/" data-width="The pixel width of the plugin" data-height="The pixel height of the plugin" data-colorscheme="light"></div>