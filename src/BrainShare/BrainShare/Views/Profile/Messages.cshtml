@using Newtonsoft.Json
@model BrainShare.Controllers.MessagingThreadViewModel

@section Scripts{
    <script type="text/javascript" src="@Url.Content("~/Scripts/custom/Profile/viewThread.js")"></script>
    <script type="text/javascript">
        $(function () {
            var model = new MessagesModel(@Html.Raw(JsonConvert.SerializeObject(Model)));
            ko.applyBindings(model);
            model.initServerCallback();
        });
    </script>
}

<div class="container">
    <h2>Сообщения</h2>
    <div class="span8">
        
        <div>
            <input type="hidden" name="threadId" id="threadId" data-bind="value: threadId" />
            <textarea style="width: 100%; height: 100px;" name="content" id="content" data-bind="value: content"></textarea>
            <button class="btn btn-large btn-primary" data-bind="click: submitMessage">Отправить</button>
        </div>
        <hr/>
        <div data-bind="foreach: messages">
            <div data-bind="attr:{class: Class}">
                <strong>от <span class="label label-inverse" data-bind="text: From"></span><span data-bind="text: Posted"></span></strong>
                <p data-bind="text: Content"></p>
            </div>
            
        </div>

    </div>
</div>

